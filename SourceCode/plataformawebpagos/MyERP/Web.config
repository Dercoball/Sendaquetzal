<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<!-- 1) DEBE ir primero -->
	<configSections>
		<sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
			<section name="Plataforma.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
		</sectionGroup>
	</configSections>

	<!-- 2) Acceso público a /Uploads -->
	<location path="Uploads">
		<system.web>
			<authorization>
				<allow users="*"/>
			</authorization>
		</system.web>
		<system.webServer>
			<security>
				<authorization>
					<add accessType="Allow" users="*"/>
				</authorization>
			</security>
		</system.webServer>
	</location>

	<system.web>
		<compilation debug="true">
			<assemblies>
			</assemblies>
		</compilation>

		<sessionState mode="InProc" cookieless="false" timeout="30" cookieName="SENDAQUETZAL_SESSION" />

		<customErrors mode="Off" />

		<pages controlRenderingCompatibilityVersion="4.0">
			<controls>
				<add assembly="Microsoft.AspNet.Web.Optimization.WebForms" namespace="Microsoft.AspNet.Web.Optimization.WebForms" tagPrefix="webopt" />
			</controls>
		</pages>

		<httpRuntime targetFramework="4.5" maxRequestLength="1048576" executionTimeout="3600" />

		<httpHandlers>
			<add verb="*" path="captimage.axd" type="Syncfusion.JavaScript.ImageHandler, Syncfusion.EJ, Version=20.4460.0.44, Culture=neutral, PublicKeyToken=3d67ed1f87d44c89" />
			<!-- Si usas ImgGarantia.ashx en modo Classic, podrías registrar aquí también -->
			<!-- <add verb="GET" path="ImgGarantia.ashx" type="ImgGarantia" /> -->
		</httpHandlers>

		<profile defaultProvider="DefaultProfileProvider">
			<providers />
		</profile>

		<membership defaultProvider="DefaultMembershipProvider">
			<providers />
		</membership>

		<roleManager defaultProvider="DefaultRoleProvider">
			<providers />
		</roleManager>
	</system.web>

	<system.codedom>
		<compilers>
			<compiler language="vb;vbs;visualbasic;vbscript" extension=".vb" type="Microsoft.CodeDom.Providers.DotNetCompilerPlatform.VBCodeProvider, Microsoft.CodeDom.Providers.DotNetCompilerPlatform, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" warningLevel="4" compilerOptions="/langversion:default /nowarn:41008 /define:_MYTYPE=&quot;Web&quot; /optionInfer+" />
		</compilers>
	</system.codedom>

	<system.webServer>
		<defaultDocument>
			<files>
				<add value="pages/Home.aspx" />
			</files>
		</defaultDocument>

		<security>
			<authorization>
				<remove users="*" roles="" verbs="" />
				<add accessType="Allow" users="*" verbs="GET,HEAD,POST,PUT,DELETE,DEBUG" />
			</authorization>
			<requestFiltering>
				<requestLimits maxAllowedContentLength="1073741824" />
			</requestFiltering>
		</security>

		<validation validateIntegratedModeConfiguration="false" />
		<modules runAllManagedModulesForAllRequests="true" />

		<handlers>
			<add verb="*" path="captimage.axd" name="syncfusion_generatetools" type="Syncfusion.JavaScript.ImageHandler, Syncfusion.EJ, Version=20.4460.0.44, Culture=neutral, PublicKeyToken=3d67ed1f87d44c89" />
			<!-- Si implementas ImgGarantia.ashx en App_Code u otro namespace, regístralo aquí -->
			<!-- <add name="ImgGarantia" path="ImgGarantia.ashx" verb="GET" type="ImgGarantia" resourceType="Unspecified" /> -->
		</handlers>

		<!-- MIME para imágenes modernas -->
		<staticContent>
			<remove fileExtension=".webp" />
			<mimeMap fileExtension=".webp" mimeType="image/webp" />
			<remove fileExtension=".svg" />
			<mimeMap fileExtension=".svg" mimeType="image/svg+xml" />
		</staticContent>
	</system.webServer>

	<system.web.extensions>
		<scripting>
			<webServices>
				<jsonSerialization maxJsonLength="900000000" />
			</webServices>
		</scripting>
	</system.web.extensions>

	<connectionStrings>
		<add name="connbd" connectionString="Server=tcp:sendaquetzalserver.database.windows.net,1433;Initial Catalog=SendaQuetzalBd;Persist Security Info=False;User ID=sisadmin;Password=Quetzal123;MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;" providerName="System.Data.SqlClient" />
	</connectionStrings>

	<runtime>
		<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
			<dependentAssembly>
				<assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral" />
				<bindingRedirect oldVersion="0.0.0.0-13.0.0.0" newVersion="13.0.0.0" />
			</dependentAssembly>
		</assemblyBinding>
	</runtime>
</configuration>
