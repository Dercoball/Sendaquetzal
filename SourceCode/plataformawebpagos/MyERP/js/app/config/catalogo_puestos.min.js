"use strict";let date=new Date,descargas="Puesto_"+date.getFullYear()+"_"+date.getMonth()+"_"+date.getUTCDay()+"_"+date.getMilliseconds(),pagina="60";class Puesto{}const puesto={init:()=>{$("#panelTabla").show(),$("#panelForm").hide(),puesto.accion="",puesto.idSeleccionado=-1,puesto.cargarItems()},cargarItems:()=>{var n={};n.path="connbd";n.idUsuario=sessionStorage.getItem("idusuario");utils.postData("../pages/Puestos.aspx/GetListaItems",n).then(n=>{console.log(n);n=n.d;let t=$("#table").DataTable({destroy:!0,processing:!0,order:[],data:n,columns:[{data:"IdPuesto"},{data:"Nombre"},{data:"Clave"},{data:"ActivoStr"},{data:"Accion"}],language:textosEsp,columnDefs:[{targets:[-1],orderable:!1},],dom:"frtiplB",buttons:[{extend:"excelHtml5",title:descargas,text:"Xls",className:"excelbtn"},{extend:"pdfHtml5",title:descargas,text:"Pdf",className:"pdfbtn"}]})})},eliminar:n=>{puesto.idSeleccionado=n,$("#panelEliminar").modal("show")},editar:n=>{$(".form-group").removeClass("has-error");$(".help-block").empty();var t={};t.path="connbd";t.id=n;t=JSON.stringify(t);$.ajax({type:"POST",url:"../pages/Puestos.aspx/GetItem",data:t,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){var t=n.d;puesto.idSeleccionado=t.IdPuesto;console.log(".");$("#txtNombre").val(t.Nombre);$("#txtClave").val(t.Clave);$("#chkActivo").prop("checked",t.Activo===1);$("#panelTabla").hide();$("#panelForm").show();puesto.accion="editar";$("#spnTituloForm").text("Editar");$(".deshabilitable").prop("disabled",!1)},error:function(n,t){console.log(t+": "+n.responseText)}})},nuevo:()=>{$("#frm")[0].reset(),$(".form-group").removeClass("has-error"),$(".help-block").empty(),$("#spnTituloForm").text("Nuevo"),$("#txtDescripcion").val(""),$("#panelTabla").hide(),$("#panelForm").show(),puesto.accion="nuevo",puesto.idSeleccionado=-1,$(".deshabilitable").prop("disabled",!1),obtenerFechaHoraServidor("txtFechaCreacion")},accionesBotones:()=>{$("#btnNuevo").on("click",n=>{n.preventDefault(),puesto.nuevo()});$("#btnGuardar").on("click",n=>{var r,i,t;(n.preventDefault(),r=$('form[name="frm"]').validator("validate").has(".has-error").length,r)||(i={},i.IdPuesto=puesto.idSeleccionado,i.Activo=$("#chkActivo").prop("checked")==!0?1:0,i.Nombre=$("#txtNombre").val(),i.Clave=$("#txtClave").val(),t={},t.path="connbd",t.item=i,t.accion=puesto.accion,t=JSON.stringify(t),$.ajax({type:"POST",url:"../pages/Puestos.aspx/Guardar",data:t,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){var t=n.d;t.CodigoError==0?(utils.toast(mensajesAlertas.exitoGuardar,"ok"),$("#panelTabla").show(),$("#panelForm").hide(),puesto.cargarItems()):utils.toast(mensajesAlertas.errorGuardar,"error")},error:function(){utils.toast(mensajesAlertas.errorGuardar,"error")}}))});$("#btnCancelar").on("click",n=>{n.preventDefault(),$("#panelTabla").show(),$("#panelForm").hide()});$("#btnEliminarAceptar").on("click",()=>{var n={};n.path="connbd";n.id=puesto.idSeleccionado;n=JSON.stringify(n);$.ajax({type:"POST",url:"../pages/Puestos.aspx/Eliminar",data:n,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){var t=n.d;t.MensajeError===null?(utils.toast(mensajesAlertas.exitoEliminar,"ok"),puesto.cargarItems()):utils.toast(t.MensajeError,"error")},error:function(n,t){console.log(t+": "+n.responseText)}})})}};window.addEventListener("load",()=>{puesto.init(),puesto.accionesBotones()});