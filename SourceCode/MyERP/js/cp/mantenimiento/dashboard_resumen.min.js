"use strict";let date=new Date,descargas="Dashboard_"+date.getFullYear()+"_"+date.getMonth()+"_"+date.getUTCDay()+"_"+date.getMilliseconds(),pagina="80";const dashBoard={init:()=>{dashBoard.cargarItems(),dashBoard.obtenerFechaHoraServidor(),dashBoard.scrollTop=100,dashBoard.incremento=100},obtenerFechaHoraServidor:()=>{var n={};n.path=window.location.hostname;n=JSON.stringify(n);$.ajax({type:"POST",url:"../pages/Proyectos.aspx/GetFechaHora",data:n,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){var t=n.d;$("#fechaHora").html(`<h1 class="texto-hora">${t.Hora} Hrs</h1>`)},error:function(n,t){console.log(t+": "+n.responseText)}})},cargarItemsColaboraciones:()=>{$("#trabajosEnColaboracion").empty().append(`
            <img src = '../img/loading.gif' class='img img-fluid'/>
        `);var n={};n.path=window.location.hostname;n.idUsuario=sessionStorage.getItem("idusuario");n.idTipoUsuario=sessionStorage.getItem("idtipousuario");utils.postData("../pages/MantenimientoDashboard.aspx/GetItemsColaboracion",n).then(n=>{var i,t;n=n.d;let r="";for(i=0;i<n.length;i++){t=n[i];let u=t.IdRequisicion==0?`
                        <div class="progress">
                            <div class="progress-bar bg-danger" role="progressbar" style="width: 100%"
                            aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">
                                Sin asignaci贸n
                            </div>
                        </div>
                        `:`<p><a href="MantenimientoListadoFallas.aspx?id=${t.IdRequisicion}" target="blank" 
                                    class="btn btn-outline-primary">OT: ${t.IdRequisicion}</a></p>

                                 <div class="progress">
                                    <div class="progress-bar bg-info" role="progressbar" style="width: 100%"
                                        aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">                                        
                                    </div>
                                </div>

                            `;r+=`


                            <div class="card mb-1 col-md-4">
                              <div class="card-body">
                                <h2 class="card-title">${t.NombreUsuario}</h2>
                                
                                ${u}

                               

                              </div>
                            </div>

                           

						`}$("#trabajosEnColaboracion").empty().append(r)})},cargarItems:()=>{$("#trabajosEnAtencion").empty().append(`
            <img src = '../img/loading.gif' class='img img-fluid'/>
        `);let n={};n.path=window.location.hostname;n.idUsuario=sessionStorage.getItem("idusuario");n.idTipoUsuario=sessionStorage.getItem("idtipousuario");utils.postData("../pages/MantenimientoDashboard.aspx/GetItemsEnAtencion",n).then(n=>{var i,t;n=n.d;let r="";for(i=0;i<n.length;i++){t=n[i];let u="";t.Tipo==="asignacion"&&(u=`

                                <p><a href="MantenimientoListadoFallas.aspx?id=${t.IdRequisicion}" target="blank" 
                                    class="btn btn-outline-primary">OT: ${t.IdRequisicion}</a></p>

                                 <div class="progress">
                                    <div class="progress-bar bg-success" role="progressbar" style="width: 100%"
                                        aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">
                                        Asignaci贸n
                                    </div>
                                </div>

                            `);t.Tipo==="colaboracion"&&(u=`

                                <p><a href="MantenimientoListadoFallas.aspx?id=${t.IdRequisicion}" target="blank" 
                                    class="btn btn-outline-primary">OT: ${t.IdRequisicion}</a></p>

                                 <div class="progress">
                                    <div class="progress-bar bg-info" role="progressbar" style="width: 100%"
                                        aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">
                                        Colaboraci贸n
                                    </div>
                                </div>

                            `);t.Tipo==="sinasignacion"&&(u=`

                            <div class="progress">
                                <div class="progress-bar bg-danger" role="progressbar" style="width: 100%"
                                aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">
                                    Sin asignaci贸n
                                </div>
                            </div>

                            `);r+=`


                            <div class="card mb-1 col-md-4">
                              <div class="card-body">

                                    <h1 class="card-title text-center">${t.NombreUsuario}</h1>

                                <div class="text-muted">${t.NombreEquipo}</div>
                                <div class="text-muted"><strong>${t.NumeroEconomico}</strong></div>
                                <div class="text-muted">${t.NombreUbicacion}</div>

                                ${u}

                               

                              </div>
                            </div>

                           

						`}$("#trabajosEnAtencion").empty().append(r);$("#toggle-btn").trigger("click");dashBoard.cargarOtsPorHacer()})},cargarOtsPorHacer:()=>{$("#itemsOtsPorHacer").empty().append(`
            <img src = '../img/loading.gif' class='img img-fluid'/>
        `);var n={};n.path=window.location.hostname;n.idUsuario=sessionStorage.getItem("idusuario");n.idTipoUsuario=sessionStorage.getItem("idtipousuario");utils.postData("../pages/MantenimientoDashboard.aspx/GetListaOtsPorHacer",n).then(n=>{n=n.d;let t="";for(let i=0;i<n.length;i++){let r=n[i],u="border: solid 1px gray;";(i+1)%3==0&&(u="border: solid 1px #2b90d9;");t+=`

                    <div class="col-md-6 h-100">
                        <div class="card ${"bg-light"} mb-3" style="width: 99%!important; ${u}">
                            <div class="card-header" >
                                                    OT<strong>${r.IdRequisicion}</strong> - ${r.NumeroEconomico}
                            </div>
                            <div class="card-body">
                                <div><small>${r.Descripcion}</small></div>
                                <div class="card-title">${r.NombreUbicacion}</div>
                         
                            </div>
                        </div> 
                    </div> `}$("#contenedorItemsPorHacer").css("height",`${$("#contenedorTrabajosEnAtencion").height()}`);$("#itemsOtsPorHacer").empty().append(t).promise().done(()=>{});setInterval(()=>{$("#contenedorItemsPorHacer").animate({scrollTop:dashBoard.scrollTop});dashBoard.scrollTop+=dashBoard.incremento;let n=$("#itemsOtsPorHacer").height();console.log(`scrollTop = ${dashBoard.scrollTop}`);console.log(`itemsOtsPorHacer height ${n}`);console.log(`incremento ${dashBoard.incremento}`);dashBoard.scrollTop>=n&&(dashBoard.incremento=0,console.log(`Reset 0`))},5e3)})},cargarTotales:()=>{$("#itemsTotales").empty().append(`
            <img src = '../img/loading.gif' class='img img-fluid'/>
        `);var n={};n.path=window.location.hostname;n.idUsuario=sessionStorage.getItem("idusuario");n.idTipoUsuario=sessionStorage.getItem("idtipousuario");utils.postData("../pages/MantenimientoDashboard.aspx/GetItemsTotalMensual",n).then(n=>{var t,i;n=n.d;let r="";for(t=0;t<n.length;t++)i=n[t],r+=`
                            <div class="container">
                                <div class="d-flex justify-content-between">
                                    <div class="left-col d-flex">
                                        <div class="text-info mr-2"><i class="fa fa-user"></i></div>
                                        <h2 class="card-title">
                                            ${i.NombreUsuario}                                        
                                        </h2>
                                    </div>
                                    <div class="right-col">
                                        <h1 class="text-success">${i.TotalRequisiciones}</h1>
                                    </div>
                                </div>
                            </div>

						`;$("#itemsTotales").empty().append(r)})},cargarFactorEficiencia:()=>{var n={};n.path=window.location.hostname;n.idUsuario=sessionStorage.getItem("idusuario");n.idTipoUsuario=sessionStorage.getItem("idtipousuario");utils.postData("../pages/MantenimientoDashboard.aspx/GetFactorEficiencia",n).then(n=>{var i,t;n=n.d;let r="";for(i=0;i<n.length;i++){t=n[i];let u=Number(t.Factor)>1.01?`<p class="texto-rojo">${number_format(t.Factor,3,"")}</p>`:`<p>${number_format(t.Factor,3,"")}</p>`;r+=`

                            <li class="d-flex justify-content-between">
                                <div class="left-col d-flex">
                                    <div class="icon"><i class="fa fa-user"></i></div>
                                    <div class="title">
                                        <strong data-id="${t.Id_Usuario}">${t.Nombre}</strong>
                                        `+u+`
                                    </div>
                                </div>
                            </li>

						`}$("#itemsFactor").empty().append(r)})},accionesBotones:()=>{}};window.addEventListener("load",()=>{dashBoard.init()});setInterval(()=>{window.location.reload()},3e5);setInterval(()=>{dashBoard.obtenerFechaHoraServidor()},6e4);