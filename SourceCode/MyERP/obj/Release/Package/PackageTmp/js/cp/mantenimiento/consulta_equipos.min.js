function descargarFormato(n){window.open("../pages/Download.ashx?path="+window.location.hostname+"&id_proyecto="+n+"&tipo=1")}function eliminar(n){idSeleccionado=n;$("#panelEliminar").modal("show")}function cargarOperadores(){var n={};n.path=window.location.hostname;n.idUsuario=sessionStorage.getItem("idusuario");n=JSON.stringify(n);$.ajax({type:"POST",url:"../pages/MantenimientoPanelRegistroFallas.aspx/GetListaOperadores",data:n,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){var t=JSON.parse(n.d),i=new $.jqx.dataAdapter(t);$("#comboOperador").jqxDropDownList({source:i,displayMember:"Nombre",valueMember:"IdEmpleado",width:"93%",height:"20px",placeHolder:"",filterable:!0,searchMode:"containsignorecase",filterPlaceHolder:"Buscar"});$("#comboOperador").jqxDropDownList("clearSelection");$("#comboOperador").jqxDropDownList({disabled:!0})},error:function(n,t){console.log(t+": "+n.responseText)}})}function abrir(n){$(".form-group").removeClass("has-error");$(".help-block").empty();accion="nuevo";var t={};t.path=window.location.hostname;t.id=n;t=JSON.stringify(t);$.ajax({type:"POST",url:"../pages/MantenimientoConsultaEquipos.aspx/GetItem",data:t,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(t){var i=t.d,r;idSeleccionado=i.IdEquipo;$("#txtNombre").val(i.Nombre);$("#txtNumeroEconomico").val(i.NumeroEconomico);$("#txtNumeroSerie").val(i.NumeroSerie);$("#comboUbicacion").val(i.IdUbicacion);$("#txtValorComercial").val(i.ValorComercial);$("#comboMarca").val(i.IdMarca);$("#chkOperativo").prop("checked",i.Activo==1);$("#comboOperador").val(i.IdOperador);$("#comboUnidadMedidaOrometro").val(i.IdUnidadMedidaOrometro);datosEquipo.cargarComboModelos(i.IdMarca,i.IdModelo);$("#txtAnio").val(i.Anio);accion="editar";$("#spnTituloForm").text("Datos del equipo");datosEquipo.odometro(n);r={};r.path=window.location.hostname;r.idEquipo=n;r=JSON.stringify(r);$.ajax({type:"POST",url:"../pages/PanelEquipos.aspx/GetFoto",data:r,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){console.log(`Foto...`);let t=n.d;t!=""&&$("#img_").attr("src",`data:image/jpg;base64,${t}`)},error:function(n,t){console.log(t+": "+n.responseText)}});$("#panelTabla").hide();$("#panelForm").show()},error:function(n,t){console.log(t+": "+n.responseText)}})}function nuevo(){$("#frm")[0].reset();$(".form-group").removeClass("has-error");$(".help-block").empty();$("#spnTituloForm").text("Nuevo");$("#panelTabla").hide();$("#panelForm").show();accion="nuevo";id="-1";idSeleccionado="-1";idClienteSeleccionado="-1";var n=new Date;$("#txtNumProyecto").prop("disabled",!0)}var accion="",idSeleccionado="-1",idClienteSeleccionado="-1",idCitaSeleccionado="-1",table,tablaCerrados,tablaClientes,tablaCitas,date=new Date,descargas="Equipos_"+date.getFullYear()+"_"+date.getMonth()+"_"+date.getUTCDay()+"_"+date.getMilliseconds(),pagina="66";$(document).ready(function(){function n(){var n={};n.path=window.location.hostname;n.idUsuario=sessionStorage.getItem("idusuario");n=JSON.stringify(n);$.ajax({type:"POST",url:"../pages/MantenimientoConsultaEquipos.aspx/GetListaItems",data:n,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){table=$("#table").DataTable({destroy:!0,processing:!0,order:[],data:n.d,columns:[{data:"NumeroEconomico"},{data:"Nombre"},{data:"NombreMarca"},{data:"NombreModelo"},{data:"ActivoStr"},{data:"OrometroUltimoMantenimiento"},{data:"Accion"}],language:textosEsp,columnDefs:[{targets:[-1],orderable:!1},],dom:"fBrtipl",buttons:[{extend:"csvHtml5",title:descargas,text:"&nbsp;Exportar Csv",className:"csvbtn"},{extend:"excelHtml5",title:descargas,text:"Xls",className:"excelbtn"},{extend:"pdfHtml5",title:descargas,text:"Pdf",className:"pdfbtn"}]})},error:function(n,t){console.log(t+": "+n.responseText)}})}$("#alert-operacion-ok").hide();$("#alert-operacion-fail").hide();$("#panelTabla").show();$("#panelForm").hide();$("#panelTablaCerrados").hide();n();datosEquipo.cargarComboMarcas();datosEquipo.cargarComboUbicaciones();cargarOperadores();datosEquipo.cargarComboUnidadesMedida();$("#btnNuevo").click(function(n){n.preventDefault();nuevo()});$("#comboMarca").on("change",function(n){n.preventDefault();datosEquipo.cargarComboModelos($("#comboMarca").val(),0)});$("#btnCancelar").click(function(n){n.preventDefault();$("#panelTabla").show();$("#panelForm").hide()});$("#btnEliminarAceptar").click(function(){var t={};t.path=window.location.hostname;t.id=idSeleccionado;t=JSON.stringify(t);$.ajax({type:"POST",url:"../pages/MantenimientoConsultaEquipos.aspx/EliminarEquipo",data:t,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(t){var i=t.d;i.MensajeError===null?($("#spnMensajes").html("Registro eliminado correctamente..."),$("#panelMensajes").modal("show"),n()):($("#spnMensajes").html(i.MensajeError),$("#panelMensajes").modal("show"))},error:function(n,t){console.log(t+": "+n.responseText)}})})});