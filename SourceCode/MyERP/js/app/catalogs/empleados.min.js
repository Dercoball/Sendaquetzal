"use strict";let date=new Date,descargas="Empleados_"+date.getFullYear()+"_"+date.getMonth()+"_"+date.getUTCDay()+"_"+date.getMilliseconds(),pagina="28";class Empleado{}const empleado={init:()=>{$("#panelTabla").show(),$("#panelForm").hide(),empleado.idSeleccionado="-1",empleado.accion="",empleado.cargarComboDepartamentos(),empleado.cargarComboPuestos(),empleado.cargarItems()},cargarItems:()=>{var n={};n.path=window.location.hostname;n.idUsuario=sessionStorage.getItem("idusuario");utils.postData("../pages/Empleados.aspx/GetListaItems",n).then(n=>{console.log(n);n=n.d;let t=$("#table").DataTable({destroy:!0,processing:!0,order:[],data:n,columns:[{data:"Clave"},{data:"Nombre"},{data:"APaterno"},{data:"AMaterno"},{data:"NombrePuesto"},{data:"NombreDepartamento"},{data:"ActivoStr"},{data:"Accion"}],language:textosEsp,columnDefs:[{targets:[-1],orderable:!1},],dom:"frtiplB",buttons:[{extend:"excelHtml5",title:descargas,text:"Xls",className:"excelbtn"},{extend:"pdfHtml5",title:descargas,text:"Pdf",className:"pdfbtn"}]})})},eliminar:n=>{empleado.idSeleccionado=n,$("#panelEliminar").modal("show")},editar:n=>{$(".form-group").removeClass("has-error");$(".help-block").empty();var t={};t.path=window.location.hostname;t.id=n;t=JSON.stringify(t);$.ajax({type:"POST",url:"../pages/Empleados.aspx/GetItem",data:t,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){var t=n.d;empleado.idSeleccionado=t.IdEmpleado;console.log(".");$("#txtNombre").val(t.Nombre);$("#txtAPaterno").val(t.APaterno);$("#txtAMaterno").val(t.AMaterno);$("#comboDepartamento").val(t.IdDepartamento);$("#comboPuesto").val(t.IdPuesto);$("#txtClave").val(t.Clave);$("#chkActivo").prop("checked",t.Activo===1);$("#panelTabla").hide();$("#panelForm").show();empleado.acccion="editar";$("#spnTituloForm").text("Editar");$(".deshabilitable").prop("disabled",!1)},error:function(n,t){console.log(t+": "+n.responseText)}})},nuevo:()=>{$("#frm")[0].reset(),$(".form-group").removeClass("has-error"),$(".help-block").empty(),$("#spnTituloForm").text("Nuevo"),$("#txtDescripcion").val(""),$("#panelTabla").hide(),$("#panelForm").show(),empleado.acccion="nuevo",empleado.idSeleccionado=-1,$(".deshabilitable").prop("disabled",!1),obtenerFechaHoraServidor("txtFechaCreacion")},cargarComboDepartamentos:()=>{var n={};n.path=window.location.hostname;n=JSON.stringify(n);$.ajax({type:"POST",url:"../pages/Empleados.aspx/GetListaItemsDepartamentos",data:n,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){for(var i,r=n.d,u="",t=0;t<r.length;t++)i=r[t],u+='<option value="'+i.IdDepartamento+'">'+i.Nombre+"<\/option>";$("#comboDepartamento").empty().append(u)},error:function(n,t){console.log(t+": "+n.responseText)}})},cargarComboPuestos:()=>{var n={};n.path=window.location.hostname;n=JSON.stringify(n);$.ajax({type:"POST",url:"../pages/Empleados.aspx/GetListaItemsPuestos",data:n,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){for(var i,r=n.d,u="",t=0;t<r.length;t++)i=r[t],u+='<option value="'+i.IdPuesto+'">'+i.Nombre+"<\/option>";$("#comboPuesto").empty().append(u)},error:function(n,t){console.log(t+": "+n.responseText)}})},accionesBotones:()=>{$("#btnNuevo").on("click",n=>{n.preventDefault(),empleado.nuevo()});$("#btnGuardar").on("click",n=>{var r,t,i;(n.preventDefault(),r=$('form[name="frm"]').validator("validate").has(".has-error").length,r)||(t={},t.IdEmpleado=empleado.idSeleccionado,t.Activo=$("#chkActivo").prop("checked")==!0?1:0,t.Nombre=$("#txtNombre").val(),t.IdDepartamento=$("#comboDepartamento").val(),t.IdPuesto=$("#comboPuesto").val(),t.APaterno=$("#txtAPaterno").val(),t.AMaterno=$("#txtAMaterno").val(),t.Clave=$("#txtClave").val(),i={},i.path=window.location.hostname,i.item=t,i.accion=empleado.acccion,i=JSON.stringify(i),$.ajax({type:"POST",url:"../pages/Empleados.aspx/Guardar",data:i,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){var t=n.d;t.CodigoError==0?(utils.toast(mensajesAlertas.exitoGuardar,"ok"),$("#panelTabla").show(),$("#panelForm").hide(),empleado.cargarItems()):utils.toast(mensajesAlertas.errorGuardar,"error")},error:function(){utils.toast(mensajesAlertas.errorGuardar,"error")}}))});$("#btnCancelar").on("click",n=>{n.preventDefault(),$("#panelTabla").show(),$("#panelForm").hide()});$("#btnEliminarAceptar").on("click",()=>{var n={};n.path=window.location.hostname;n.id=empleado.idSeleccionado;n=JSON.stringify(n);$.ajax({type:"POST",url:"../pages/Empleados.aspx/Eliminar",data:n,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){var t=n.d;t.MensajeError===null?(utils.toast(mensajesAlertas.exitoEliminar,"ok"),empleado.cargarItems()):utils.toast(t.MensajeError,"error")},error:function(n,t){console.log(t+": "+n.responseText)}})})}};window.addEventListener("load",()=>{empleado.init(),empleado.accionesBotones()});