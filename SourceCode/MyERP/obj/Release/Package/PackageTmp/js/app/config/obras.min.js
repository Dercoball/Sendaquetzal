function eliminar(n){idSeleccionado=n;$("#panelEliminar").modal("show")}function editar(n){$(".form-group").removeClass("has-error");$(".help-block").empty();var t={};t.path=window.location.hostname;t.id=n;t=JSON.stringify(t);$.ajax({type:"POST",url:"../pages/Obras.aspx/GetItem",data:t,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){var t=n.d;$("#txtNombre").val(t.Nombre);$("#chkActivo").prop("checked",t.Activo==1?!0:!1);idSeleccionado=t.IdObra;accion="editar";$("#spnTituloForm").text("Editar");$("#panelTabla").hide();$("#panelForm").show()},error:function(n,t){console.log(t+": "+n.responseText)}})}var accion="",idSeleccionado="-1",table,date=new Date,descargas="Obras_"+date.getFullYear()+"_"+date.getMonth()+"_"+date.getUTCDay()+"_"+date.getMilliseconds(),pagina="55";$(document).ready(function(){function n(){var n={};n.path=window.location.hostname;n.idUsuario=sessionStorage.getItem("idusuario");n=JSON.stringify(n);$.ajax({type:"POST",url:"../pages/Obras.aspx/GetListaItems",data:n,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(n){table=$("#table").DataTable({destroy:!0,processing:!0,order:[],data:n.d,columns:[{data:"Nombre"},{data:"ActivoStr"},{data:"UltimaModificacionStr"},{data:"Accion"}],language:textosEsp,columnDefs:[{targets:[-1],orderable:!1}],dom:"fBrtip",buttons:[{extend:"csvHtml5",title:descargas,text:"&nbsp;Exportar Csv",className:"csvbtn"},{extend:"pdfHtml5",title:descargas,text:"Xls",className:"pdfbtn"}]})},error:function(n,t){console.log(t+": "+n.responseText)}})}$("#panelTabla").show();$("#panelForm").hide();n();$("#btnGuardar").click(function(t){var u,r,i;t.preventDefault();u=$('form[name="frm"]').validator("validate").has(".has-error").length;u||($("#panelLoading").modal("show"),r={},r.IdObra=idSeleccionado,r.Nombre=$("#txtNombre").val(),r.Activo=$("#chkActivo").prop("checked")?1:0,i={},i.path=window.location.hostname,i.item=r,i.accion=accion,i.idUsuario=sessionStorage.getItem("idusuario"),i=JSON.stringify(i),$.ajax({type:"POST",url:"../pages/Obras.aspx/Guardar",data:i,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(t){var i=parseInt(t.d);$("#panelLoading").show("fast",function(){setTimeout(function(){$("#panelLoading").modal("hide")},500)});i>0?(utils.toast(mensajesAlertas.exitoGuardar,"ok"),$("#panelTabla").show(),$("#panelForm").hide(),n()):utils.toast(mensajesAlertas.errorGuardar,"fail");$("#panelEdicion").modal("hide")},error:function(n,t){console.log(t+": "+n.responseText)}}))});$("#btnNuevo").on("click",function(n){n.preventDefault();idSeleccionado=-1;$("#frm")[0].reset();$(".form-group").removeClass("has-error");$(".help-block").empty();$("#spnTituloForm").text("Nuevo");$("#panelTabla").hide();$("#panelForm").show();accion="nuevo"});$("#btnCancelar").on("click",function(n){n.preventDefault();$("#panelTabla").show();$("#panelForm").hide()});$("#btnEliminarAceptar").on("click",function(){var t={};t.path=window.location.hostname;t.id=idSeleccionado;t.idUsuario=sessionStorage.getItem("idusuario");t=JSON.stringify(t);$.ajax({type:"POST",url:"../pages/Obras.aspx/EliminarItem",data:t,contentType:"application/json; charset=utf-8",dataType:"json",async:!0,success:function(t){var i=t.d;i>0?(utils.toast(mensajesAlertas.exitoEliminar,"ok"),table.destroy(),n()):utils.toast(mensajesAlertas.errorEliminar,"fail")},error:function(n,t){console.log(t+": "+n.responseText)}})})});