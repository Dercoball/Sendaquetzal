"use strict";class PanelSolicitudRefacciones{}const panelGuarantee={init:()=>{$("#panelFormGarantias").hide(),$("#panelFormGarantiasAval").hide(),panelGuarantee.accion="",panelGuarantee.idPrestamo=-1},view(n){panelGuarantee.idPrestamo=n;panelGuarantee.cargarItemsCustomer(n);console.log("Asignar id del prestamo al paneeeel "+n)},cargarItemsCustomer:n=>{var t={};t.path=window.location.hostname;t.idUsuario=sessionStorage.getItem("idusuario");t.idPrestamo=n;t=JSON.stringify(t);$.ajax({type:"POST",url:"../../pages/Loans/LoansIndex.aspx/GetListGuaranteeCustomer",data:t,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){let t=$("#tableGarantias").DataTable({pageLength:50,destroy:!0,processing:!0,order:[],data:n.d,columns:[{data:"Nombre"},{data:"NumeroSerie"},{data:"Costo"},{data:"Fecha"},{data:"Accion"},],language:textosEsp,columnDefs:[{targets:[0,1,2,3,4],orderable:!1},],dom:"t"});$("#tableGarantias").on("draw.dt",function(){});$("#tableGarantias").trigger("draw.dt")},error:function(n,t){console.log(t+": "+n.responseText)}})},nuevoGarantiaCliente:()=>{$("#frmGarantias")[0].reset(),$(".form-group").removeClass("has-error"),$(".help-block").empty(),panelGuarantee.accion="nuevo",$("#panelTablaGarantias").hide(),$("#panelFormGarantias").show()},nuevoGarantiaAval:()=>{console.log("nuevo garantia aval"),$("#frmGarantias")[0].reset(),$(".form-group").removeClass("has-error"),$(".help-block").empty(),panelGuarantee.accion="nuevo",$("#panelTablaGarantiasAval").hide(),$("#panelFormGarantiasAval").show()},cancelarRefacciones:n=>{panelGuarantee.idRefaccionSeleccionada=n,$("#msgCancelar").html(mensajesAlertas.confirmacionCancelarRefaccion.replace("{numrefaccion}",n)),$("#panelCancelarRefaccion").modal("show")},accionesBotones:()=>{$("#btnEliminarAceptarRefaccion").on("click",()=>{var n={};n.path=window.location.hostname;n.id=panelGuarantee.idRefaccionSeleccionada;n=JSON.stringify(n);$.ajax({type:"POST",url:"../pages/MantenimientoPanelSolicitudRefacciones.aspx/CancelarRefaccion",data:n,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){$("#panelCancelarRefaccion").modal("hide");var t=n.d;t.MensajeError===null?utils.toast(mensajesAlertas.exitoCancelarRefaccion,"ok"):utils.toast(t.MensajeError,"error")},error:function(n,t){console.log(t+": "+n.responseText)}})});$("#btnNuevaGarantia").on("click",n=>{n.preventDefault(),panelGuarantee.nuevoGarantiaCliente()});$("#btnNuevaGarantiaAval").on("click",n=>{n.preventDefault(),panelGuarantee.nuevoGarantiaAval()});$("#btnGuardarGarantiaCliente").on("click",n=>{var r,i,u,t;(console.log("llego"),n.preventDefault(),r=$('form[name="frmRefaccion"]').validator("validate").has(".has-error").length,r)||(i={},u=$("#imgGarantee").prop("files")[0],i.IdGarantia=0,i.Nombre=$("#txtNombreGarantia").val(),i.NumeroSerie=$("#txtNumeroSerie").val(),i.Costo=$("#txtCosto").val(),t={},t.path=window.location.hostname,t.item=i,t.idUsuario=document.getElementById("txtIdUsuario").value,t.idPrestamo=panelGuarantee.idPrestamo,console.log("idPrestamo = "+panelGuarantee.idPrestamo),t=JSON.stringify(t),$.ajax({type:"POST",url:"../../pages/Loans/LoansIndex.aspx/SaveCustomerGuarantee",data:t,contentType:"application/json; charset=utf-8",dataType:"json","async":!0,success:function(n){var t=n.d;parseInt(t.CodigoError)==0?(utils.toast(mensajesAlertas.exitoGuardar,"ok"),$("#panelTablaGarantias").show(),$("#panelFormGarantias").hide(),$(".file-fotografia").each(function(){let n;(n=this.files[0])&&utils.sendFileEmployee(n,"garantia",t.IdItem,0,"garantia")})):utils.toast(mensajesAlertas.errorGuardar,"error")},error:function(n,t){console.log(t+": "+n.responseText);utils.toast(mensajesAlertas.errorGuardar,"error")}}))});$("#btnCancelarGarantíaCliente").on("click",n=>{n.preventDefault(),$("#panelTablaGarantias").show(),$("#panelFormGarantias").hide()});$("#btnCancelarGarantíaAval").on("click",n=>{n.preventDefault(),$("#panelTablaGarantiasAval").show(),$("#panelFormGarantiasAval").hide()})}};window.addEventListener("load",()=>{panelGuarantee.init(),panelGuarantee.accionesBotones()});